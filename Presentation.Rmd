---
title: "A Reproducible Science Workflow in RStudio"
author: "Egor"
date: "April 21, 2018"
# output: 
#   ioslides_presentation:
#     widescreen: true
#     transition: faster
output:
  revealjs::revealjs_presentation:
    self_contained: false
    reveal_plugins: ["notes"]

---

```{r setup, include=FALSE}
library(knitr)
library(pander)
opts_chunk$set(echo = FALSE)
# opts_chunk$set(results = 'asis')
panderOptions('table.split.table', Inf)
panderOptions('keep.line.breaks',  TRUE)
panderOptions('table.alignment.rownames', 'left')

```

## Myself 
> - Bachelor in Computer Science and Biology at McGill
> - Fan of open source software
> - Started using R in grad school
>   - Collaboration with co-supervisor in England
>   - No easy way to transmit results
> - Discovered RMarkdown this year \
`r include_graphics("Introduction/Brain.png")`

<div class="notes">
- R was very confusing
- Different ways to access dataframes versus lists versus matrixes. 
- Not one good way to do object oriented programming. 
- Apply functions instead of for loops.
</div>

## Why go reproducible?
> - Avoid errors
> - Computational reproducibility
> - Easy revision



## Outline

> - Reproducible documents
> - Project management and organization
> - Version control

## Reproducible Document

> - Computes all numbers
> - Avoids transcription errors
> - Removes ambiguity
> - Easy revision 

# Generating Reproducible Documents
<div class="notes">
These slides were generated entirely in RStudio. \
I did not open PowerPoint, or Google Slides even once.
</div>

## R Markdown

> - Simple formatting syntax for HTML, PDF and MS Word
> - Integrate "chunks" of R (or Python) code 
>   - Generate code, plots, and tables
> - Write complex equations
> - Knit = export to HTML/Word/PDF

## Displaying code and output

```{r, echo=TRUE}
print("Hello ~~World~~ **CEEB**!")
```

## Displaying data

```{r cars, echo=TRUE, results='asis'}
pander(head(cars), col.names = c("Speed (&mu;m/h)", "Distance Travelled (&mu;m)"))
```

## Plots

```{r plot, fig.height=5*0.9, fig.width=7*0.9, echo=TRUE, warning=FALSE, message=FALSE}
library(ggplot2); library(cowplot)
ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) + geom_point()
```

## And Reporting Test Results

```{r echo=TRUE, results='asis'}
fit <- lm(dist~speed, data=cars)
pander(summary(fit))
```

## Reproducible Manuscripts

> - Use existing templates (rticles or papaja package)
> - If no template exists:
>     - Write some text/code in RMarkdown
>     - Knit to Word document
>     - Change style definitions in Word
>     - Use styled doc as a template
>     - Repeat
> - Use bibtex for citations (citr)

# Project Management

## Why have a good workflow?
> - Keep a clean workspace and focus on one thing at a time \
`r include_graphics("Introduction/Desk.jpg")`
> - Make collaboration and sharing work easier

## Basics

`r include_graphics("Project/Structure.png")`

- Keep project in one folder
- Keep raw data folder read-only
- Avoid duplicating code

## In RStudio

- Use RStudio Projects \
`r include_graphics("Project/rstudio.png")`
- ProjectTemplate package

# Version Control

## Confusing and messy filenames
```{r }
include_graphics("Version control/Filenames.gif")
```

## Better alternatives 
> - Informative filenames
> - Periodically archiving the whole project (eg: zip)
> - Many cloud based serices (also serves as backup) \
```{r}
include_graphics("Version control/Dropbox.png")
cat("\t\t\t")
include_graphics("Version control/Drive.png")
cat("\t")
include_graphics("Version control/OneDrive.png")
```

## Best alternative 
> - Use software designed for version control
>     - Git or SVN
> - Alows you to keep track of *key* changes
> - Makes you fearless
> - Works with GitHub for easy collaboration and cloud backup
> - Supported in RStudio

## Git basics

`r include_graphics("Version control/git-transport.png") `


## Resources
 - R for Reproducible Scientific Analyses https://swcarpentry.github.io/r-novice-gapminder/
 - How to use GitHub with RStudio http://happygitwithr.com/
 - Excuse me, do you have a moment to talk about version control? https://dx.doi.org/10.7287%2Fpeerj.preprints.3159v2.
 - Guide to RMarkdown https://rmarkdown.rstudio.com/lesson-1.html
 - RMarkdown for writing reproducible scientific papers https://libscie.github.io/rmarkdown-workshop/handout.html
 -Happy collaboration with Rmd to docx https://rmarkdown.rstudio.com/articles_docx.html

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
